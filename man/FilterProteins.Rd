% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/FilterProteins.R
\name{FilterProteins}
\alias{FilterProteins}
\title{Filter Proteins by Mixture Model Detection}
\usage{
FilterProteins(geomx_set, neg_ctrl = "Rt IgG2a")
}
\arguments{
\item{geomx_set}{A \code{NanoStringGeoMxSet} object processed by \code{\link{MixModelFit}}.}

\item{neg_ctrl}{Character. The negative control probe to use as the noise baseline.
The threshold is calculated as \code{mean(neg_ctrl) + 1 * SD(neg_ctrl)}.

\strong{Recommended Options:}
\itemize{
\item "Rt IgG2a" (Often the lowest background)
\item "Hmr IgG"
\item "Ms IgG2b"
\item "Rb IgG"
\item "Ms IgG1"
}}
}
\value{
A subsetted \code{NanoStringGeoMxSet} object containing only the detected proteins.
It also prints the lists of kept and excluded proteins to the console.
}
\description{
Subsets the GeoMxSet object to retain only proteins that have a detectable signal
above the negative control background in at least one fitted model.
}
\details{
\strong{Filtering Logic:}
\enumerate{
\item Recalculates the background threshold based on the user-selected \code{neg_ctrl}.
\item Iterates through every protein and every model fit stored in \code{experimentData}.
\item Checks if the \strong{highest component mean} (max mu) of the model exceeds the threshold.
\item If a protein's signal is \strong{below} the threshold in \strong{ALL} tested models
(ncomp 1..N, ev T/F), it is considered "undetected" and removed.
\item Negative control probes are always retained for reference.
}
}
\examples{
\dontrun{
  # Filter using the standard Rt IgG2a background
  geomx_filtered <- FilterProteins(geomx_set, neg_ctrl = "Rt IgG2a")
}
}
