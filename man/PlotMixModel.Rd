% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/PlotMixModel.R
\name{PlotMixModel}
\alias{PlotMixModel}
\title{Plot Mixture Model Fit}
\usage{
PlotMixModel(
  geomx_set,
  protein,
  ncomp = NULL,
  ev = NULL,
  neg_ctrl = "Rt IgG2a"
)
}
\arguments{
\item{geomx_set}{A \code{NanoStringGeoMxSet} object processed by \code{\link{MixModelFit}}.}

\item{protein}{Character. The name of the protein to plot.}

\item{ncomp}{Integer (Optional). The number of components to plot.
If \code{NULL}, the function auto-selects the best model based on the lowest BIC score
stored in the object.}

\item{ev}{Logical (Optional). Equal variance assumption.
If \code{NULL}, the function auto-selects the best model based on BIC.}

\item{neg_ctrl}{Character. The negative control probe to use as the noise baseline.
The threshold is calculated as \code{mean(neg_ctrl) + 1 * SD(neg_ctrl)}.

\strong{Recommended Options:}
\itemize{
\item "Rt IgG2a" (Often the lowest background)
\item "Hmr IgG"
\item "Ms IgG2b"
\item "Rb IgG"
\item "Ms IgG1"
}}
}
\value{
A \code{\link[ggplot2]{ggplot}} object showing:
\itemize{
\item Histogram of observed data (density scale)
\item Gaussian curves for individual components (filled areas)
\item Total mixture curve (black line)
\item Threshold line (red dashed) with annotation
\item Subtitle indicating if the protein is considered "Detected" (max component mean > threshold)
}
}
\description{
This function generates a density plot of the log10-transformed data for a selected protein.
It overlays the fitted mixture components (as filled areas) and the total model fit (as a black line).
A red dashed line indicates the background noise threshold, calculated dynamically based on
the selected negative control probe.
}
\details{
Visualizes the fitted Gaussian mixture model for a specific protein, overlaid with a
dynamic negative control threshold to assess signal detection.

The function retrieves fit parameters directly from \code{experimentData(object)@other$MixModel}.
It calculates the detection threshold on the fly using the provided \code{neg_ctrl}.
If \code{ncomp} and \code{ev} are not provided, it scans the stored results to find the
model combination (ncomp/ev) with the lowest BIC for that specific protein.
}
\examples{
\dontrun{
  # Plot using auto-detected best parameters and default control
  PlotMixModel(geomx_set, "CD44")

  # Plot using a specific control and model parameters
  PlotMixModel(geomx_set, "CD44", ncomp = 2, ev = FALSE, neg_ctrl = "Ms IgG1")
}
}
\seealso{
\code{\link{MixModelFit}}, \code{\link{FilterProteins}}
}
